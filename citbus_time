#!/usr/bin/env python3
# SPDX-FileCopyrightText: 2026 Ryu Taniguchi
# SPDX-License-Identifier: BSD-3-Clause
import sys
import os
from datetime import datetime

def main():
    if len(sys.argv) > 1:
        try:
            now = datetime.strptime(sys.argv[1], "%H:%M")
            now = now.replace(year=datetime.now().year, 
                              month=datetime.now().month, 
                              day=datetime.now().day)
        except ValueError:
            now = datetime.now()
    else:
        now = datetime.now()

    current_time = now.replace(second=0, microsecond=0)
        
    candidates = []
    lines = []

    input_source = sys.stdin.read().strip()

    if not input_source:
        return

    if os.path.isfile(input_source):
        try:
            with open(input_source, 'r') as f:
                lines = f.readlines()
        except OSError:
            lines = input_source.splitlines()
    else:
        lines = input_source.splitlines()

    for line in lines:
        line = line.strip()
        if not line:
            continue
        
        try:
            bus_time = datetime.strptime(line, "%H:%M")
            bus_time = bus_time.replace(year=now.year, month=now.month, day=now.day)
            candidates.append(bus_time)
        except ValueError:
            continue

    candidates.sort()

    found = False
    for bus in candidates:
        if bus >= current_time:
            diff = bus - current_time
            minutes = int(diff.total_seconds() / 60)
            print(f"{bus.strftime('%H:%M')} (あと {minutes} 分)")
            found = True
            break 

    if not found:
        print("本日の便は終了しました")

if __name__ == '__main__':
    main()
